<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="title">æ’è¡Œæ¦œ</view>
    <view class="subtitle">çœ‹çœ‹è°æ˜¯æ‰‹åŠ¿è¾¾äºº</view>
  </view>

  <!-- æ’è¡Œæ¦œç±»å‹åˆ‡æ¢ -->
  <view class="tab-container">
    <view class="tab {{currentTab === 'speed' ? 'active' : ''}}" bindtap="switchTab" data-tab="speed">
      <view class="tab-icon">âš¡</view>
      <view class="tab-text">æœ€å¿«è§£é”</view>
    </view>
    <view class="tab {{currentTab === 'accuracy' ? 'active' : ''}}" bindtap="switchTab" data-tab="accuracy">
      <view class="tab-icon">ğŸ¯</view>
      <view class="tab-text">æœ€é«˜è¿ç»­æ­£ç¡®</view>
    </view>
  </view>

  <!-- æœ€å¿«è§£é”æ’è¡Œæ¦œ -->
  <view class="ranking-list" wx:if="{{currentTab === 'speed'}}">
    <view class="ranking-item" wx:for="{{speedRanking}}" wx:key="index">
      <view class="rank-number {{item.rank <= 3 ? 'top-three' : ''}}">{{item.rank}}</view>
      <view class="user-avatar">
        <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      </view>
      <view class="user-info">
        <view class="user-name">{{item.nickname || 'åŒ¿åç”¨æˆ·'}}</view>
        <view class="user-desc">
          <text wx:if="{{item.rows === 3}}">3Ã—3æ‰‹åŠ¿</text>
          <text wx:if="{{item.rows === 4}}">4Ã—4æ‰‹åŠ¿</text>
          <text>â€¢ {{item.gestureLength}}ä¸ªç‚¹</text>
        </view>
      </view>
      <view class="score-info">
        <view class="score">
          <text class="score-value">{{(item.bestTime / 1000).toFixed(2)}}</text>
          <text class="score-unit">ç§’</text>
        </view>
        <view class="badge" wx:if="{{item.rank === 1}}">ğŸ†</view>
        <view class="badge" wx:if="{{item.rank === 2}}">ğŸ¥ˆ</view>
        <view class="badge" wx:if="{{item.rank === 3}}">ğŸ¥‰</view>
      </view>
    </view>
  </view>

  <!-- æœ€é«˜è¿ç»­æ­£ç¡®æ’è¡Œæ¦œ -->
  <view class="ranking-list" wx:if="{{currentTab === 'accuracy'}}">
    <view class="ranking-item" wx:for="{{accuracyRanking}}" wx:key="index">
      <view class="rank-number {{item.rank <= 3 ? 'top-three' : ''}}">{{item.rank}}</view>
      <view class="user-avatar">
        <image src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      </view>
      <view class="user-info">
        <view class="user-name">{{item.nickname || 'åŒ¿åç”¨æˆ·'}}</view>
        <view class="user-desc">
          <text>å…±æŒ‘æˆ˜{{item.totalChallenges}}æ¬¡</text>
          <text>â€¢ æˆåŠŸç‡{{item.successRate}}%</text>
        </view>
      </view>
      <view class="score-info">
        <view class="score">
          <text class="score-value">{{item.continuousCorrect}}</text>
          <text class="score-unit">æ¬¡</text>
        </view>
        <view class="badge" wx:if="{{item.rank === 1}}">ğŸ†</view>
        <view class="badge" wx:if="{{item.rank === 2}}">ğŸ¥ˆ</view>
        <view class="badge" wx:if="{{item.rank === 3}}">ğŸ¥‰</view>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„æ’å -->
  <view class="my-rank-section">
    <view class="section-title">æˆ‘çš„æ’å</view>
    <view class="my-rank-card">
      <view class="rank-left">
        <view class="user-avatar large">
          <image src="{{myInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        </view>
        <view class="user-info">
          <view class="user-name">{{myInfo.nickname || 'ç‚¹å‡»ç™»å½•'}}</view>
          <view class="rank-text">
            <text wx:if="{{currentTab === 'speed'}}">æœ€å¿«: {{(myInfo.bestTime / 1000).toFixed(2)}}ç§’</text>
            <text wx:if="{{currentTab === 'accuracy'}}">è¿ç»­æ­£ç¡®: {{myInfo.continuousCorrect}}æ¬¡</text>
          </view>
        </view>
      </view>
      <view class="rank-right">
        <view class="rank-number {{myInfo.rank <= 10 ? 'top-ten' : ''}}">{{myInfo.rank > 0 ? myInfo.rank : '-'}}</view>
        <view class="rank-desc" wx:if="{{myInfo.rank === 0}}">æš‚æ— æ’å</view>
      </view>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="statistics-section">
    <view class="section-title">å…¨å±€ç»Ÿè®¡</view>
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-number">{{totalPlayers}}</view>
        <view class="stat-label">å‚ä¸ç©å®¶</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{totalChallenges}}</view>
        <view class="stat-label">æ€»æŒ‘æˆ˜æ¬¡æ•°</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{totalSuccess}}</view>
        <view class="stat-label">æˆåŠŸè§£é”</view>
      </view>
    </view>
  </view>

  <!-- ç™»å½•æç¤º -->
  <view class="login-prompt" wx:if="{{!hasUserInfo}}">
    <view class="prompt-content">
      <view class="prompt-icon">ğŸ”</view>
      <view class="prompt-text">ç™»å½•åå³å¯å‚ä¸æ’è¡Œæ¦œ</view>
      <button class="login-btn" open-type="getUserInfo" bindgetuserinfo="onGetUserInfo">ç«‹å³ç™»å½•</button>
    </view>
  </view>
</view>
